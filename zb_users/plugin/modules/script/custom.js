"use strict";
!function(t){var e=$("body");e.on("click",t.click,(function(){var s="ajax_upload"+(new Date).getTime(),o=$(this);e.append(`<input type="file" id="${s}" accept="${t.accept}" style="display:none">`);var n=$("#"+s);e.one("change","#"+s,(function(){var e=new FormData;e.append("file",$(this)[0].files[0]),$.ajax({url:ajaxurl+t.src,type:"POST",dataType:"json",data:e,contentType:!1,processData:!1,xhr:function(){var e,s=new XMLHttpRequest;return s.upload.addEventListener("progress",(function(s){s.lengthComputable&&(e=Math.floor(s.loaded/s.total*100),t.progress&&t.progress(o,e))})),s},success:function(e){t.success(o,e)},error:function(e){t.error&&t.error(o,e)}})})),n.click()}))}({src:"modules_upload",click:".uploadimg",accept:".jpg,.jpeg,.png,.gif,.bmp,.svg",success:function(t,e){t.parents("p,tr").find(".thumbsrc").attr("value",e.url),t.parents("p,tr").find(".thumbimg").attr("src",e.url)},error:function(t){$.toast("上传失败",2e3,"center")}}),$((function(){$(".help").hover((function(){$(this).next().show()}),(function(){$(this).next().hide()})),$(".helpcon").hover((function(){$(this).show()}),(function(){$(this).hide()})),$.fn.smartFloat=function(){return $(this).each((function(){var t,e;t=$(this),e=t.position().top,t.css("position"),$(window).scroll((function(){var s=$(this).scrollTop();s>e?window.XMLHttpRequest?t.css({position:"fixed",top:0}):t.css({top:s}):t.css({position:"absolute",top:e})}))}))},$("aside.left").smartFloat(),$(".tmain dd.half:odd").addClass("right");var t=$("#PostSIDETHUMBON").next("span"),e=$("#PostSIDERANDTHUMBON").next("span");function s(t,e){$(t).prev("input");var s=$(e).prev("input");$(e).hasClass("imgcheck-on")&&($(e).removeClass("imgcheck-on"),s.val("0"))}if(t.click((function(){s(this,e)})),e.click((function(){s(this,t)})),$.toast=function(t,e,s){var o;o=$('<div class="toast '+s+'"><div class="toasttext">'+t+"</div></div>"),$("body").append(o),setTimeout((()=>{o.find(".toasttext").addClass("toastclose"),setTimeout((()=>{o.remove()}),200)}),e)},$("[data-stretch]").each((function(){var t=$(this).data("stretch");$(this).find(".imgcheck").bind("click",(function(){$(this).hasClass("imgcheck-on")?$("."+t+"info").hide():$("."+t+"info").show()}))})),$("#PostCUSTOMCSS")[0]){var o=CodeMirror.fromTextArea($("#PostCUSTOMCSS")[0],{lineNumbers:!0,theme:"default",foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0,styleActiveLine:!0});setTimeout((()=>{o.refresh()}),1)}document.onkeydown=function(t){if(83==((t=t||event||window.event).keyCode||t.which||t.charCode)&&(t.ctrlKey||t.metaKey))return $(".setbtn").click(),!1},theme.ajaxpost&&$(".setting [type=submit]").click((function(){let t=$(this),e=t.parents("form"),s=e.attr("action"),n=t.val();return $("#PostCUSTOMCSS")[0]&&$("#PostCUSTOMCSS").text(o.getValue()),t.attr("disabled","disabled").val("正在保存..."),$.post(s,e.serialize(),(function(e,s){t.removeAttr("disabled").val(n),"success"==s?$.toast("保存成功！",2e3,"center"):$.toast("保存失败！",2e3,"center")})),!1}))}));